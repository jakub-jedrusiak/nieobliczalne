{
  "hash": "ea7cc444f405dc7575cdeeb1172ccdd2",
  "result": {
    "markdown": "---\ntitle: Gęstość prawdopodobieństwa i rozkład normalny\ndescription: Istnieje szczególny rodzaj wykresów zwany wykresami gęstości. I bardzo łatwo jest czytać je źle. A nie jest to pierwszy lepszy wykres -- wykresy gęstości prawdopodobieństwa to fundament całej statystyki. Dlatego w tym wpisie omawiam, jak czytać takie wykresy, co one oznaczają, a także co to jest rozkład normalny i jego dystrybuanta.\ndate: 2023-08-27\nfreeze: auto\ndraft: true\ncode-fold: true\n---\n\n\n\n\nPomimo tego, że rozkład normalny jest podstawą statystyki jako takiej, **nie trzeba go rozumieć, żeby używać statystyki**. Jest to użyteczna wiedza, którą musimy posiąść, jeśli *naprawdę* chcemy rozumieć, co robimy. Jednak da się żyć i sprawnie wyciągać wnioski statystyczne i bez tej wiedzy. Ten wpis można potraktować więc jako spojrzenie w głębię statystyki, ale na pierwsze zetknięcie z tą dziedziną znacznie lepiej przeczytać wpisy o [wariancji](procent-wariancji.qmd) i o [wartości $p$](p-value.qmd).\n\n# Histogramy i gęstość prawdopodobieństwa\n\nWyobraźmy sobie, że losujemy 2000 osób i robimy im test inteligencji, np. WAIS-R. Przeliczamy, jak naszym badanym poszło, patrzymy w tabelki z normami i dla każdej osoby badanej uzyskujemy wynik na specjalnej skali do wyrażania inteligencji. Skala ta jest zrobiona tak, żeby światowa średnia inteligencja zawsze wynosiła $\\mu = 100$, a odchylenie standardowe $\\sigma = 15$. Na razie nie jest ważne, czym jest odchylenie standardowe matematycznie (zainteresowanym polecam [wpis o wariancji](./procent-wariancji.qmd)). Chodzi w nim mniej więcej o to, że większość (około $\\frac{2}{3}$) populacji ma wyniki między 85 a 115, czyli 100±15. Wyniki przedstawiamy na histogramie.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_tys <- tibble(IQ = rnorm(2000, 100, 15))\nggplot(p_tys, aes(IQ)) +\n    geom_histogram(binwidth = 20, fill = \"gray95\", colour = \"black\") +\n    ylim(0, 1100) +\n    labs(x = \"IQ\", y = \"liczba osób w próbce\") +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Histogram inteligencji w próbie 2000 osób. Wynik na osi Y to liczba osób, których inteligencja mieści się w danych widełkach. Szerokość jednego słupka to 20 punktów.](gestosc-prawdopodobienstwa_files/figure-html/fig-histogram-1-1.png){#fig-histogram-1 width=672}\n:::\n:::\n\n\nJak czytać coś takiego? Każdy słupek to pewne widełki. Tutaj ustawiłem te widełki na szerokość 20 punktów. I tak na przykład środkowy słupek to widełki 90-110. Z osi Y naszego histogramu możemy odczytać, że takich osób w naszej próbce było trochę ponad 900. W widełkach 70-90 i 110-130 uplasowało się trochę po prawie 500 osób itd. Fakt, że w histogramie każdy słupek reprezentuje wartości od-do jest niepozorny, ale potem okaże się bardzo ważny.\n\nZamiast prezentować bezwzględne liczby możemy użyć proporcji. Trochę ponad 900 osób to w naszej próbce trochę mniej niż 50%. Jest to wygodne, ponieważ odcina trochę sam histogram od wielkości próby. Ponieważ próba ma być tylko przybliżeniem prawdziwej populacji, to ostatecznie nie interesuje nas, ile osób w próbie miało inteligencję między 90 a 100, tylko jaki procent osób w całej Polsce ma inteligencję między 90 a 100. Z naszej próby możemy wnioskować, że takich osób jest trochę mniej niż 50%.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    geom_histogram(aes(y = after_stat(count / sum(count))), binwidth = 20, fill = \"gray95\", colour = \"black\") +\n    labs(x = \"IQ\", y = \"odsetek osób w próbce\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.6)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Tym razem na osi Y umieściłem nie liczebność danej grupy, a jaki procent stanowi ona w całej próbie.](gestosc-prawdopodobienstwa_files/figure-html/fig-histogram-2-1.png){#fig-histogram-2 width=672}\n:::\n:::\n\n\nTakie przedstawienie sprawy odblokowuje nam jednak nowy sposób myślenia o tym rozkładzie -- jeśli miałbym teraz losowo wybrać jedną osobę z tej grupy, to mam trochę mniej niż 50% szans, że będzie z widełek 90-110, trochę ponad 20%, że będzie z widełek 110-130 itd. Ta zmiana osi Y sprawiła, że możemy patrzeć na nasz histogram jako na **histogram prawdopodobieństwa**. Słupki możemy też do siebie dodawać, np. skoro widełki 90-110 mają prawdopodobieństwo 47%, a widełki 110-130 mają prawdopodobieństwo 24%, to łącznie widełki 90-130 mają prawdopodobieństwo 71%.\n\nMożemy jednak być niezadowoleni z tej dokładności. Co jeśli chcę stwierdzić, jaką mam szansę znaleźć osobę z węższych widełek, np. 95-105? Nasze słupki są zbyt szerokie, żeby to określić, ale możemy je zawęzić i uzyskać dokładniejszy obraz.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    geom_histogram(aes(y = after_stat(count / sum(count))), binwidth = 10, fill = \"gray95\", colour = \"black\") +\n    labs(x = \"IQ\", y = \"odsetek osób w próbce\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.3)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Zmniejszenie szerokości słupków (tutaj do 10) sprawia, że histogram jest dokładniejszy. Każdy słupek z osobna ma też mniejsze prawdopodobieństwo.](gestosc-prawdopodobienstwa_files/figure-html/fig-histogram-3-1.png){#fig-histogram-3 width=672}\n:::\n:::\n\n\nNa rysunku [-@fig-histogram-3]. każdy słupek ma szerokość 10, więc nasze widełki skurczyły się do 95-105, 105-115, 115-130 itd. Warto też zwrócić uwagę, że każdy ze słupków stał się niższy. Łączne prawdopodobieństwo musi zawsze wynosić 100%, więc skoro rozbijam tę wartość na więcej kawałków, to każdy kawałek musi być, siłą rzeczy, mniejszy. Widać to na rysunku [-@fig-histogram-4], gdzie nakładam na siebie szerszy i węższy histogram.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    geom_histogram(aes(y = after_stat(count / sum(count))), binwidth = 20, fill = \"gray95\", colour = \"black\", alpha = 0.5) +\n    geom_histogram(aes(y = after_stat(count / sum(count))), binwidth = 10, fill = \"gray75\", colour = \"black\", alpha = 0.5) +\n    labs(x = \"IQ\", y = \"odsetek osób w próbce\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.6)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Po nałożeniu na siebie histogramów widać, jak się różnią.](gestosc-prawdopodobienstwa_files/figure-html/fig-histogram-4-1.png){#fig-histogram-4 width=672}\n:::\n:::\n\n\nA co jeśli taka dokładność też mnie nie zadowala? Mogę spróbować zmniejszyć dokładność do 1 punktu, wtedy będę mógł liczyć prawdopodobieństwo dla dowolnych widełek.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    geom_histogram(aes(y = after_stat(count / sum(count))), binwidth = 1, fill = \"gray95\", colour = \"black\", linewidth = 0.1) +\n    labs(x = \"IQ\", y = \"odsetek osób w próbce\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Ten histogram ma już bardzo wąskie słupki, bo o szerokości zaledwie 1 punktu. Maksymalne prawdopodobieństwo wynosi już poniżej 3%.](gestosc-prawdopodobienstwa_files/figure-html/fig-histogram-5-1.png){#fig-histogram-5 width=672}\n:::\n:::\n\n\nSuper, może nie jest to zbyt wygodny wykres, ale dodając do siebie słupki możemy wyliczyć prawdopodobieństwo dowolnego wyniku, np. widełek 101-103. WAIS-R pozwala nam uzyskać wyniki z dokładnością do 1 punktu, więc niżej nie ma po co schodzić. Chyba że...\n\nOwszem, nasze testy inteligencji dają wyniki z określoną dokładnością, ale zakładamy, że inteligencja istnieje naprawdę. Teoretycznie ludzie mogą się różnić inteligencją o pół punktu, ale nie mamy narzędzi, żeby to wykryć. Możemy też sobie wyobrazić, że mierzymy zmienne, które rzeczywiście są ciągłe, np. reakcję skórno-galwaniczną (wskaźnik stresu), rozszerzenie źrenic, tempo oddechu itd. Źrenice naprawdę mogą rozszerzyć się o kolejne 0,0001 mm i tylko od naszej aparatury pomiarowej zależy, czy będziemy w stanie to wykryć. Możemy więc sobie wyobrazić, że zwężamy nasze słupki jeszcze bardziej i bardziej i bardziej, aż w końcu będą one nieskończenie cienkie i tak naprawdę utworzą nam ciągłą linię. Taki wykres nazywamy **wykresem gęstości**. Na skali Y mamy procenty, więc możemy taki wykres nazwać **wykresem gęstości prawdopodobieństwa**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    geom_density(fill = \"gray95\") +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Wykres gęstości prawdopodobieństwa na podstawie naszej próbki, który możemy rozumieć jako histogram ze słupkami tak cienkimi, że zlewają się w jedno pole.](gestosc-prawdopodobienstwa_files/figure-html/fig-density-1-1.png){#fig-density-1 width=672}\n:::\n:::\n\n\nPowyższy wykres gęstości jest ilustracją naszej próbki. Każda taka próbka będzie się różniła co do szczegółów. Nasza próbka liczyła sobie 2000 osób. Możemy się domyślić, że próbka 3000 osób da dokładniejsze wyniki. 4000 osób da jeszcze dokładniejsze wyniki. 10 000 osób jeszcze dokładniejsze itd. Ostatecznie taki rozkład będzie się zbliżał do równiutkiego, regularnego kształtu zwanego **krzywą dzwonową**. Rozkład o takim kształcie nazywamy **rozkładem normalnym**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    geom_area(stat = \"function\", fun = dnorm, args = list(mean = 100, sd = 15), fill = \"gray95\", colour = \"black\") +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![Wykres gęstości prawdopodobieństwa z rozkładu normalnego ma kształt krzywej dzwonowej.](gestosc-prawdopodobienstwa_files/figure-html/fig-density-2-1.png){#fig-density-2 width=672}\n:::\n:::\n\n\n# Gęstość prawdopodobieństwa *vs.* prawdopodobieństwo\n\nDokładny wykres gęstości prawdopodobieństwa pozwala nam liczyć prawdopodobieństwo dla dowolnych zakresów z dowolną dokładnością. Czai się tutaj jednak pewna pułapka. Gdy patrzymy na nasz wykres gęstości, chciałoby się powiedzieć, że szansa na to, że ktoś będzie miał inteligencję równą 100 wynosi ok. 2,5%. Z tym wnioskowaniem jest jednak pewien znaczący problem, który prezentuje tabela [-@tbl-likelihood].\n\n\n::: {#tbl-likelihood .cell tbl-cap='Wartości z osi Y dla IQ między 95 a 105 co 0.25.'}\n\n```{.r .cell-code}\npoints <- tibble(X = seq(95, 105, 0.25), Y = dnorm(X, 100, 15))\n\nkbl(points, booktabs = TRUE, row.names = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> X </th>\n   <th style=\"text-align:right;\"> Y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 95.00 </td>\n   <td style=\"text-align:right;\"> 0.0251589 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 95.25 </td>\n   <td style=\"text-align:right;\"> 0.0252955 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 95.50 </td>\n   <td style=\"text-align:right;\"> 0.0254259 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 95.75 </td>\n   <td style=\"text-align:right;\"> 0.0255498 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 96.00 </td>\n   <td style=\"text-align:right;\"> 0.0256671 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:right;\"> 96.25 </td>\n   <td style=\"text-align:right;\"> 0.0257779 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:right;\"> 96.50 </td>\n   <td style=\"text-align:right;\"> 0.0258819 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:right;\"> 96.75 </td>\n   <td style=\"text-align:right;\"> 0.0259792 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:right;\"> 97.00 </td>\n   <td style=\"text-align:right;\"> 0.0260695 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:right;\"> 97.25 </td>\n   <td style=\"text-align:right;\"> 0.0261529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:right;\"> 97.50 </td>\n   <td style=\"text-align:right;\"> 0.0262293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> 97.75 </td>\n   <td style=\"text-align:right;\"> 0.0262986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 13 </td>\n   <td style=\"text-align:right;\"> 98.00 </td>\n   <td style=\"text-align:right;\"> 0.0263608 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:right;\"> 98.25 </td>\n   <td style=\"text-align:right;\"> 0.0264158 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:right;\"> 98.50 </td>\n   <td style=\"text-align:right;\"> 0.0264635 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 </td>\n   <td style=\"text-align:right;\"> 98.75 </td>\n   <td style=\"text-align:right;\"> 0.0265040 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:right;\"> 99.00 </td>\n   <td style=\"text-align:right;\"> 0.0265371 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 18 </td>\n   <td style=\"text-align:right;\"> 99.25 </td>\n   <td style=\"text-align:right;\"> 0.0265629 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 19 </td>\n   <td style=\"text-align:right;\"> 99.50 </td>\n   <td style=\"text-align:right;\"> 0.0265814 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 20 </td>\n   <td style=\"text-align:right;\"> 99.75 </td>\n   <td style=\"text-align:right;\"> 0.0265925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 21 </td>\n   <td style=\"text-align:right;\"> 100.00 </td>\n   <td style=\"text-align:right;\"> 0.0265962 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 22 </td>\n   <td style=\"text-align:right;\"> 100.25 </td>\n   <td style=\"text-align:right;\"> 0.0265925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 23 </td>\n   <td style=\"text-align:right;\"> 100.50 </td>\n   <td style=\"text-align:right;\"> 0.0265814 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 24 </td>\n   <td style=\"text-align:right;\"> 100.75 </td>\n   <td style=\"text-align:right;\"> 0.0265629 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 25 </td>\n   <td style=\"text-align:right;\"> 101.00 </td>\n   <td style=\"text-align:right;\"> 0.0265371 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 26 </td>\n   <td style=\"text-align:right;\"> 101.25 </td>\n   <td style=\"text-align:right;\"> 0.0265040 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 27 </td>\n   <td style=\"text-align:right;\"> 101.50 </td>\n   <td style=\"text-align:right;\"> 0.0264635 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 28 </td>\n   <td style=\"text-align:right;\"> 101.75 </td>\n   <td style=\"text-align:right;\"> 0.0264158 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 29 </td>\n   <td style=\"text-align:right;\"> 102.00 </td>\n   <td style=\"text-align:right;\"> 0.0263608 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 30 </td>\n   <td style=\"text-align:right;\"> 102.25 </td>\n   <td style=\"text-align:right;\"> 0.0262986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 31 </td>\n   <td style=\"text-align:right;\"> 102.50 </td>\n   <td style=\"text-align:right;\"> 0.0262293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 32 </td>\n   <td style=\"text-align:right;\"> 102.75 </td>\n   <td style=\"text-align:right;\"> 0.0261529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 33 </td>\n   <td style=\"text-align:right;\"> 103.00 </td>\n   <td style=\"text-align:right;\"> 0.0260695 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 34 </td>\n   <td style=\"text-align:right;\"> 103.25 </td>\n   <td style=\"text-align:right;\"> 0.0259792 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 35 </td>\n   <td style=\"text-align:right;\"> 103.50 </td>\n   <td style=\"text-align:right;\"> 0.0258819 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 36 </td>\n   <td style=\"text-align:right;\"> 103.75 </td>\n   <td style=\"text-align:right;\"> 0.0257779 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 37 </td>\n   <td style=\"text-align:right;\"> 104.00 </td>\n   <td style=\"text-align:right;\"> 0.0256671 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 38 </td>\n   <td style=\"text-align:right;\"> 104.25 </td>\n   <td style=\"text-align:right;\"> 0.0255498 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 39 </td>\n   <td style=\"text-align:right;\"> 104.50 </td>\n   <td style=\"text-align:right;\"> 0.0254259 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 40 </td>\n   <td style=\"text-align:right;\"> 104.75 </td>\n   <td style=\"text-align:right;\"> 0.0252955 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 41 </td>\n   <td style=\"text-align:right;\"> 105.00 </td>\n   <td style=\"text-align:right;\"> 0.0251589 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nTo są dokładne wartości z osi Y dla 41 różnych punktów z osi X. Zaczynamy od 95 i dochodzimy do 105 co 0,25. Załóżmy, że chcemy policzyć prawdopodobieństwo, że losowa osoba znajdzie się w widełkach 95-105. Innymi słowy jaka część naszej próbki wykazała inteligencję między 95 a 105. Z wykresu [-@fig-histogram-3]. spodziewamy się, że wyjdzie około 25%. Dodajemy więc zgromadzone w tabeli wartości i wychodzi nam, że nasze prawdopodobieństwo wynosi 107%. Chwila, co?\n\nRzeczywiście nie ma to sensu. Nie dość, że prawdopodobieństwo nie może być większe niż 100%, to wychodzi na to, że 107% naszej próbki miało inteligencję z przedziału 95-105. A przecież jest jeszcze cała reszta rozkładu. Ba! między punktem 100 i 101 jest nieskończona liczba punktów! Jeśli zamiast co 0,25 wykorzystałbym krok 0,1, prawdopodobieństwo wzrosłoby do 264%, zaś przy kroku 0,01, wyniesie 2614%! Dlaczego tak się dzieje?\n\nPrzypomnijmy sobie rysunek [-@fig-histogram-4]. Zauważyliśmy na nim, że im węższe są nasze słupki, tym każdy pojedynczy słupek musi być niższy, żeby zawsze dodawały się do 100%. Nagle jednak stwierdziłem, że zrobię słupki nieskończenie cienkie. Idąc zwykłą logiką, automatycznie powinny się one stać nieskończenie niskie. Jednak gdy program statystyczny liczy wykres gęstości prawdopodobieństwa, korzysta z zaawansowanych matematycznie narzędzi, które pozwalają uzyskać efekt ciągłej linii bez redukcji pojedynczych prawdopodobieństw do zera. I musimy o tym pamiętać, gdy korzystamy z tych wykresów.\n\nTo, co znajduje się na osi Y, określamy ankielskim słowem *likelihood*, co bywa tłumaczone jako właśnie *gęstość prawdopodobieństwa* albo *wiarygodność*. Nas jednak nie obchodzi gęstość prawdopodobieństwa tylko samo prawdopodobieństwo! To, co intuicyjnie rozumiemy przez *prawdopodobieństwo*, oddaje angielski termin *probability* i jest zupełnie czymś innym niż *likelihood*. Jest to kluczowe rozróżnienie dla wykresów gęstości w ogóle -- **gęstość prawdopodobieństwa i prawdopodobieństwo to dwie różne rzeczy**! Gęstość prawdopodobieństwa możemy odczytać z osi Y, a skąd wziąć prawdopodobieństwo?\n\nWykres gęstości możemy wyobrazić sobie jako histogram. Ponieważ jest to histogram, to zawsze potrzebujemy jakichś widełek. A niech będą cieniutkie, ale jakieś są potrzebne. W poprzednim przykładzie wzięliśmy prawdziwe widełki 95-105 i próbowaliśmy dodawać do siebie cienkie prostokąty między tymi wartościami. Istnieje jednak bardzo duża różnica pomiędzy cienkimi a nieskończenie cienkimi prostokątami! Skoro są nieskończenie cienkie, to jest ich też nieskończona liczba. A jak dodać do siebie nieskończoną liczbę nieskończenie cienkich prostokątów i przy okazji nie otrzymać nieskończenie wielkiej wartości? Wydaje się to niemożliwe, ale matematyka ma do tego narzędzia.\n\n# Prawdopodobieństwo z wykresów gęstości\n\nTak jak wcześniej powiedziałem, jeśli chcemy z wykresu gęstości otrzymać prawdopodobieństwo, to -- jak przy każdym histogramie -- musimy ustalić sobie jakieś widełki. Mogą to być widełki pomiędzy jakimiś wartościami, np. IQ 95-105, ale też nierówności typu „IQ mniejsze od 85” albo „IQ większe niż 130”. Zanim zaczniemy liczyć dokładnie, nauczymy się szacować prawdopodobieństwo.\n\n## Szacowanie prostokątami Riemanna\n\nZałóżmy ponownie, że chcemy policzyć, jaka część populacji wykazuje inteligencję między 95 a 105. Od razu podam odpowiedź -- 26,11%. Nic nam po samej odpowiedzi, jeśli nie umiemy tego liczyć, ale miejmy to w głowie, gdy będziemy patrzeć, jak dobrze udało nam się oszacować. Zaznaczmy sobie przestrzeń, o którą nam chodzi.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnormal <- list(stat = \"function\", fun = dnorm, args = list(mean = 100, sd = 15))\n\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\") +\n    exec(geom_area, !!!normal, fill = \"#DB3D3D\", xlim = c(95, 105)) +\n    stat_function(fun = dnorm, args = list(mean = 100, sd = 15)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nŻeby odczytać prawdopodobieństwo z takiego wykresu, musimy oszacować, wielkość przestrzeni, którą zaznaczyłem na czerwono. Wielkość przestrzeni, czyli... pole. Na czerwono zaznaczony jest prawie prostokąt, tylko ma brzuszek na górze. Jeśli będę mógł oszacować pole tego prostokąta, to to pole właśnie będzie naszym prawdopodobieństwem. Jak więc to zrobić? Bardzo z grubsza możemy brzuszek zignorować i udawać, że jest to rzeczywiście prostokąt.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\", colour = \"black\") +\n    annotate(geom = \"rect\", fill = \"#DB3D3D\", colour = \"#8F1A1A\", ymin = 0, ymax = dnorm(100, 100, 15), xmin = 95, xmax = 105, alpha = 0.25) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nSzerokość tego prostokąta wynosi 10 (bo od 95 do 105), zaś jego wysokość odczytujemy z osi Y, czyli jest taka, jak gęstość prawdopodobieństwa dla $x = 100$. Odczytywanie tej wielkości z wykresu szybko robi się niepraktyczne, dlatego możemy ją wyliczyć. Możemy to zrobić podstawiając bezpośrednio do wzoru (który wygląda tak strasznie, że go nie pokażę), wykorzystując funkcję `dnorm(100, 100, 15)` w R (pierwszy argument to wartość, drugi to średnia, trzeci odchylenie standardowe), korzystając z [internetowego kalkulatora](https://www.danielsoper.com/statcalc/calculator.aspx?id=54) albo kalkulatora naukowego. Możemy teraz skorzystać ze wzoru na pole prostokąta i, po wybiciu się z flashbacków ze szkoły podstawowej, otrzymać wynik:\n\n$$\nP \\approx 0.02659 \\times 10 = 0,2659 = 26,59\\%\n$$\n\nNieźle! Pomimo tak zgrubnego oszacowania, błąd wynosi mniej niż 1 punkt procentowy. Tworzy nam się więc recepta -- wystarczy pomnożyć gęstość prawdopodobieństwa przez szerokość widełek i wyjdzie! Co nie? No i tak, i nie. Powyższy przykład pokazuje, że czasem to zadziała. Zobaczmy jednak, co się stanie, jak będziemy chcieli tak oszacować wartość dla szerszego przedziału 70-130.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\", colour = \"black\") +\n    annotate(geom = \"rect\", fill = \"#DB3D3D\", colour = \"#8F1A1A\", ymin = 0, ymax = dnorm(100, 100, 15), xmin = 70, xmax = 130, alpha = 0.25) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nWysokość się nie zmieniła, zaś szerokość wzrosła do 60. Podstawienie tego do wzoru da nam prawdopodobieństwo 159,58%. No. Przesadziliśmy. Jak widać na wykresie, nasz prostokąt wystaje spoza krzywej tak bardzo, że mocno zawyża pole. To może zmienić strategię i wciśnijmy nasz prostokąt pod krzywą, żeby na pewno nie wystawał?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\", colour = \"black\") +\n    annotate(geom = \"rect\", fill = \"#DB3D3D\", colour = \"#8F1A1A\", ymin = 0, ymax = dnorm(70, 100, 15), xmin = 70, xmax = 130, alpha = 0.25) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nWysokość tego prostokąta równa jest gęstości prawdopodobieństwa w punktach 70 i 130. Rozkład normalny jest symetryczny, więc oba te punkty mają taką samą wysokość -- są tak samo oddalone od środka, o 30 punktów. Policzenie pola tego prostokąta ujawnia nam to, co widać już na oko, czyli że pole jest znacznie zaniżone, bowiem wychodzi $P \\approx 60 \\times 0,0036 = 0,216 = 21,6\\%$. Wiemy więc tyle, że nasze pole jest nie mniejsze niż 0,216 i nie większe niż 1,6. Super. Tyle to widzę na oko.\n\nMożemy jednak zmienić strategię i zamiast wyznaczać jednego dużego prostokąta, wyznaczyć wiele małych. Na przykład nasz przedział możemy podzielić na 7 prostokątów po 10[^1]. W ten sposób wykres gęstości zaczyna trochę przypominać histogram, ale trzeba pamiętać, że po to rysujemy prostokąty, żeby policzyć pole.\n\n[^1]: Zakładając, że prostokąty mają dotykać wykresu środkiem, skrajne prostokąty wystają 5 w prawo i 5 w lewo, stąd dodatkowe 10. Inne metody szacowania obejmują prostokąty dotykające wykresu rogiem (prawym lub lewym) albo nawet zastąpienie prostokątów trapezami.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nriemann <- tibble(X = seq(70, 130, 10), Y = dnorm(X, 100, 15))\n\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\", colour = \"black\") +\n    geom_col(data = riemann, aes(X, Y), fill = \"#DB3D3D\", colour = \"#8F1A1A\", alpha = 0.25, width = resolution(riemann$X)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nNasze prostokąty mają środki w punktach 70, 80, 90, 100, 110, 120 i 130. Gdy policzymy gęstość prawdopodobieństwa dla każdego z tych punktów i przemnożymy przez szerokość 10, to wychodzi nam pole $P \\approx 0,9826 = 98,26\\%$. Wartość prawdziwa to $P \\approx 0,9545$, więc błąd ewidentnie zmalał. I maleje bardziej, gdy narysujemy jeszcze cieńsze prostokąty.\n\nWróćmy pamięcią do tabeli [@tbl-likelihood]. Zaznaczyłem tam 41 punktów od 95 do 105 licząc co 0,25. Następnie zsumowałem te wartości i otrzymałem 107%. Ale wyobraźmy sobie to, co zrobiłem, nieco inaczej. Wyznaczyłem wysokość 41 prostokątów, z których każdy miał szerokość 0,25. Następnie dodałem wszystkie wysokości, ale zignorowałem szerokość. Jeśli teraz uwzględnię, że liczę pole i każdy prostokąt[^2] przemnożę przez 0,25, to powinienem otrzymać niezłe oszacowanie! I rzeczywiście, 41 prostokątów o szerokości 0,25 pozwala nam oszacować powierzchnię między 95 a 105 na 26,74%. W porównaniu z prawdziwą wartością 26,11%, jest to naprawdę bardzo bliskie oszacowanie.\n\n[^2]: Albo pomnożę wcześniej uzyskaną sumę przez 0,25. Wynika to z tego, że 0,25 można wyciągnąć przed nawias: $$\\begin{align*} P & = a \\times b_1 + a \\times b_2 + \\dots + a \\times b_{41} = \\\\ & = a \\times (b_1 + b_2 + \\dots + b_{41})\\end{align*}$$\n\n## Zapis całkowy\n\nSzacowanie pola pod krzywą za pomocą prostokątów Riemanna, czyli to, co zrobiliśmy wyżej, to stara i skuteczna metoda. Jeśli chcemy otrzymać naprawdę dokładne wartości, możemy dzielić pole na setki, tysiące, miliony prostokątów i uzyskać przez to dowolną dokładność naszego oszacowania. Technicznie jednak żadna z tych wartości nie będzie doskonale dokładna. Nie ma to praktycznego znaczenia, ale jeśli chcemy zachować matematyczną czystość, musimy skorzystać z pewnego szczególnego zapisu.\n\nWiemy już, że prostokąty pod krzywą są nieskończenie cienkie. Wiemy też, że wzór na pole prostokąta to długość razy szerokość. Spójrzmy na taki „nieskończenie” cienki prostokąt.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\", colour = \"black\") +\n    annotate(geom = \"rect\", fill = \"#DB3D3D\", colour = \"#8F1A1A\", ymin = 0, ymax = dnorm(100, 100, 15), xmin = 99.9, xmax = 100.1, alpha = 0.25) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nWysokość tego prostokąta to gęstość prawdopodobieństwa dla $IQ = 100$. Możemy zapisać to pewną przerażająco wyglądającą notacją $\\mathcal{N}(100;\\ 100,\\ 15^2)$. Oznacza to „wartość rozkładu normalnego o średniej $\\mu = 100$ i wariancji $\\sigma^2 = 15^2$ w punkcie 100”. Każdy rozkład normalny daje się dwiema liczbami -- średnią i odchyleniem standardowym. Jak znam te dwie rzeczy, mogę liczyć. Warto zwrócić uwagę, że podajemy w tej notacji wariancję, a nie odchylenie standardowe, ale (jak pamiętamy z wpisu o [wariancji](procent-wariancji.qmd)) wariancja to odchylenie standardowe do kwadratu.\n\nSzerokość naszego prostokąta jest nieskończenie mała, co możemy zapisać jako $dx$, co w matematyce w uproszczeniu oznacza „nieskończenie mała wartość z osi X”.\n\nPole takiego prostokąta zapisalibyśmy więc jako $P = \\mathcal{N}(100;\\ 100,\\ 15^2) \\times dx$. Ponieważ taki prostokąt jest nieskończenie cienki, to $dx$ to właściwie zero, więc i pole jednego takiego prostokąta jest zerowe. Ale jeśli dodamy nieskończoną liczbę takich prostokątów, może coś nam z tego wyjdzie. Oczywiście w praktyce one nigdy nie będą *nieskończenie cienkie*, ale gdy zawężamy je coraz bardziej, to nasz wynik *zbliża się* do prawdziwego wyniku.\n\nMatematyka pozwala nam zapisać nasze zamiary w dokładny sposób. Możemy na przykład zapisać coś w rodzaju „dodaję pola wszystkich nieskończenie małych prostokątów między 95 a 105”. W praktyce takie dodawanie musi mieć jakąś konkretną szerokość tych prostokątów, więc robilibyśmy to tak:\n\n$$\n\\begin{align*}\nP & \\approx \\mathcal{N}(95;\\ 100,\\ 15^2) \\times 0.001 + \\\\\n& + \\mathcal{N}(95,001;\\ 100,\\ 15^2) \\times 0.001 + \\\\\n& + \\mathcal{N}(95,002;\\ 100,\\ 15^2) \\times 0.001 + \\\\\n& + \\dots + \\\\\n& + \\mathcal{N}(105;\\ 100,\\ 15^2) \\times 0.001\n\\end{align*}\n$$\n\nMatematyka pozwala nam jednak naprawdę zapisać, że dodajemy *wszystkie*, naprawdę *nieskończenie* cienkie prostokąty. Dla wszystkich prostokątów między 95 a 105 zapis taki wygląda tak:\n\n$$\nP = \\int^{105}_{95} \\mathcal{N}(x;\\ 100,\\ 15^2) dx\n$$\n\nRozciągnięta litera S oznacza sumę, liczby w jej indeksach mówią, odkąd dokąd ma sumować, zaś to, co następuje dalej to to, co ma sumować -- pole prostokąta o wysokości równej gęstości prawdopodobieństwa w punkcie i nieskończenie małej szerokości. Nazywamy to **całką oznaczoną**. Oznaczona, bo ma jakieś konkretne granice, konkretny przedział, w którym ma robić tę sumę. Teraz i Ty możesz śmiać się słysząc, że wchodzi całka oznaczona do pociągu, a to nie jej przedział.\n\nŻeby lepiej było widać, co to oznacza w naszym wypadku, zapiszę to jeszcze w taki sposób:\n\n$$\nP (95 < IQ < 105) = \\int^{105}_{95} \\mathcal{N}(IQ;\\ 100,\\ 15^2) dIQ\n$$\n\n# Dystrybuanta rozkładu normalnego\n\nWiemy więc już, jak zapisywać i jak szacować wartości prawdopodobieństwa z rozkładu normalnego. Jest to jednak czynność na tyle powszechna, że ma swoje własne, szczególne drogi na skróty. Najważniejszą z nich jest tak zwana **dystrybuanta**. Za tą straszną nazwą kryje się prosta idea, jaką jest suma krocząca prawdopodobieństwa. Co to znaczy? Załóżmy, że chcemy policzyć prawdopodobieństwo wysolowania osoby z IQ poniżej 85. Na wykresie wygląda to tak:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\") +\n    exec(geom_area, !!!normal, fill = \"#DB3D3D\", xlim = c(min(p_tys$IQ), 85)) +\n    stat_function(fun = dnorm, args = list(mean = 100, sd = 15)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nMożemy wykorzystać nowo poznaną notację całkową, żeby wyrazić, co chcemy zrobić:\n\n$$\nP(IQ < 85) = \\int^{85}_{-\\infty} \\mathcal{N}(x;\\ 100,\\ 15^2) dx\n$$\n\n...czyli policz pole od $-\\infty$, czyli tak bardzo w lewo, jak sięgniesz, do 85. Jak wiemy, prawdopodobieństwo z wykresu gęstości to właśnie pole.\n\nTo jest dokładnie to, co robi dystrybuanta. Dystrybuanta to taka funkcja, co jak do niej wrzucę 85, to ona mi powie, jakie jest prawdopodobieństwo, że wylosuję 85 *lub niżej*. Dystrybuanta często jest oznaczana jako CDF od *cumulative distribution function* i można ją znaleźć w wielu kalkulatorach, w Excelu, w R występuje jako funkcja `pnorm()`, na jednej z setek [stron internetowych](https://www.danielsoper.com/statcalc/calculator.aspx?id=53), a także... drukowaną w książkach.\n\n## Mniejsze niż\n\nSpórbujmy wykorzystać współczesne narzędzia[^3], żeby odpowiedzieć na zadane pytanie -- jakie jest prawdopodobieństwo, że losowo wybrana z populacji osoba będzie miała inteligencję 85 albo mniejszą?\n\n[^3]: Ja wykorzystam tutaj R, ale możesz skorzystać z zalinkowanego [kalkulatora](https://www.danielsoper.com/statcalc/calculator.aspx?id=53). Przy tej okazji polecam swoje [wprowadzenie do R](podstawy_R.qmd) oraz rozważenie kupna kalkulatora naukowego z opcją liczenia dystrybuanty. Ja używam Casio fx-991CEX i sobie chwalę. Teraz zastępuje go druga edycja Casio fx-991ES PLUS.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\npnorm(85, 100, 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1586553\n```\n\n\n:::\n:::\n\n\n## Większe niż\n\nMożemy też odpowiadać na pytania odwrotne, np. jakie jest prawdopodobieństwo, że losowo wybrany człowiek klasyfikuje się do Mensy (czyli ma IQ powyżej 130)? Na wykresie wygląda to tak:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\") +\n    exec(geom_area, !!!normal, fill = \"#DB3D3D\", xlim = c(130, max(p_tys$IQ))) +\n    stat_function(fun = dnorm, args = list(mean = 100, sd = 15)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nMożemy to ugryźć na dwa sposoby. Jeśli nasz kalkulator nam to umożliwia, możemy przełączyć dystrybuantę na jej lustrzane odbicie, czyli wprost powiedzieć, żeby wyrzuciła nam wartości *większe* niż 130 zamiast zwyczajnych mniejszych. W R możemy to zrobić ustawiając argument `lower.tail = FALSE`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\npnorm(130, 100, 15, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02275013\n```\n\n\n:::\n:::\n\n\nBardziej klasyczny sposób opiera się na tym, że prawdopodobieństwo sumarycznie musi wynosić 1. Możemy więc ze zwykłej dystrybuanty policzyć prawdopodobieństwo, że IQ wynosi *mniej niż* 130, a następnie otrzymaną wartość odjąć od 1. Tak też możesz zrobić korzystając z kalkulatora internetowego.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n1 - pnorm(130, 100, 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02275013\n```\n\n\n:::\n:::\n\n\nSwoją drogą przypomnę, że prawdopodobieństwo odpowiada tutaj odsetkowi osób w próbie lub w populacji. Możemy więc policzyć na przykład, ilu potencjalnych Mensan zamieszkuje Polskę:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# liczba mieszkańców Polski (2022) razy odsetek potencjalnych Mensan\n37766327 * pnorm(130, 100, 15, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 859188.9\n```\n\n\n:::\n:::\n\n\n## Między danymi wartościami {#sec-pomiedzy}\n\nNa początku tego wpisu powiedziałem, że odchylenie standardowe $\\sigma = 15$ oznacza, że około $\\frac{2}{3}$ populacji znajduje się w widełkach 85-115, czyli 100±15. Skąd to wiedziałem? Cóż, możemy to policzyć.\n\nWiele kalkulatorów pozwala na policzenie wartości według danych widełek, ale część pozwala tylko na liczenie czystej dystrybuanty czyli prawdopodobieństwa, że wartość będzie *mniejsza* niż zadana. Na wykresie od naszej wartości w lewo. Możemy jednak wykorzystać dystrybuantę do policzenia odsetka populacji *pomiędzy* jakimiś wartościami. Robimy to w dwóch krokach.\n\nPo pierwsze, liczymy wartość dystrybuanty dla górnych widełek, czyli w naszym przypadku 115.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\") +\n    exec(geom_area, !!!normal, fill = \"#DB3D3D\", xlim = c(min(p_tys$IQ), 115)) +\n    stat_function(fun = dnorm, args = list(mean = 100, sd = 15)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nNastępnie liczymy dystrybuantę dla dolnych widełek, czyli w tym wypadku 85.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\") +\n    exec(geom_area, !!!normal, fill = \"#DB3D3D\", xlim = c(min(p_tys$IQ), 115)) +\n    exec(geom_area, !!!normal, fill = \"#3DDB6A\", xlim = c(min(p_tys$IQ), 85)) +\n    stat_function(fun = dnorm, args = list(mean = 100, sd = 15)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nA na koniec odejmujemy jedno od drugiego.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(p_tys, aes(IQ)) +\n    exec(geom_area, !!!normal, fill = \"gray95\") +\n    exec(geom_area, !!!normal, fill = \"#DB3D3D\", xlim = c(85, 115)) +\n    stat_function(fun = dnorm, args = list(mean = 100, sd = 15)) +\n    labs(x = \"IQ\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent, limits = c(0, 0.03)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nW R możemy to zrobić tak:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\npnorm(115, 100, 15) - pnorm(85, 100, 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6826895\n```\n\n\n:::\n:::\n\n\nJak widzimy, można z grubsza powiedzieć, że w rozkładzie normalnym ±1 odchylenie standardowe przekłada się na $\\frac{2}{3}$ populacji albo $P(\\mu \\pm 1\\sigma) = 68,2\\%$. Na tej samej zasadzie $P(\\mu \\pm 2\\sigma) = 95,4\\%$ i $P(\\mu \\pm 3\\sigma) = 99,5\\%$. Ta intuicja bywa nazywana **prawem trzech sigm**.\n\n[![Rycina ilustrująca prawo trzech sigm na Wikipedii](https://upload.wikimedia.org/wikipedia/commons/8/8c/Standard_deviation_diagram.svg \"M. W. Toews, CC BY 2.5 &lt;https://creativecommons.org/licenses/by/2.5&gt;, via Wikimedia Commons\"){fig-alt=\"Standard deviation diagram\" width=\"100%\"}](https://commons.wikimedia.org/wiki/File:Standard_deviation_diagram.svg)\n\n::: callout-tip\n## Zadanie\n\nJakie jest prawdopodobieństwo wylosowania osoby o inteligencji:\n\n1.  mniejszej niż -2 odchylenia standardowe (czyli $100 - 2 \\times 15 = 70$),\n\n2.  większej niż +1 odchylenie standardowe,\n\n3.  między -1 odchyleniem standardowym a średnią,\n\n4.  dokładnie 100.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Odpowiedź\n\n1.  $P(IQ < 70) = \\int^{70}_{-\\infty} \\mathcal{N}(x;\\ 100,\\ 15^2) dx \\approx 0,02275013 \\approx 2,28\\%$\n\n2.  $P(IQ > 115) = \\int^{\\infty}_{115} \\mathcal{N}(x;\\ 100,\\ 15^2) dx \\approx 0,1586553 \\approx 15,87\\%$\n\n3.  $P(85 > IQ > 100) = \\int^{100}_{85} \\mathcal{N}(x;\\ 100,\\ 15^2) dx \\approx 0,3413447 \\approx 34,13\\%$\n\n4.  Do tego pytania można podejść dwojako. Możemy stwierdzić, że dokładnie 100 to jest pojedynczy nieskończenie cienki prostokąt, a więc prawdopodobieństwo (jego pole) wynosi zero. Lepiej to widać na rozszerzeniu źrenic -- dokładnie 7 mm oznacza brak nawet jednej milionowej odchylenia, więc jest właściwie niemożliwe. Pamiętaj -- wykres gęstości działa jak histogram, więc potrzebuje widełek. Możemy jednak stwierdzić, że wyniki między 99,5 a 100,5 zaokrąglają się do 100 i to uznać za odpowiedź. W takim wypadku $P(IQ \\approx 100) = \\int^{100,5}_{99,5} \\mathcal{N}(x;\\ 100,\\ 15^2) dx \\approx 0.02659123 \\approx 2,66\\%$.\n:::\n\n## Odwrotna dystrybuanta\n\nKażda funkcja ma swoją funkcję odwrotną. Tak samo dystrybuanta. Do dystrybuanty wrzucamy maksymalną wartość z rozkładu (np. maksymalne IQ), a ona zwraca, jaki procent populacji cechuje taka lub niższa wartość. Do odwrotnej dystrybuanty wrzucamy, jaki procent populacji chcemy objąć, a ona wyrzuca maksymalną wartość z rozkładu.\n\nZałóżmy, że chcemy do jakiegoś projektu włączyć ludzi z górnych 10% rozkładu inteligencji. Czyli jak dobrze musi wypaść w teście inteligencji dana osoba, żeby zostać włączona do projektu? Jakie minimalne IQ musi uzyskać? Na takie właśnie pytania odpowiada odwrotna dystrybuanta. Przykładowy kalkulator można znaleźć [tutaj](https://planetcalc.com/4987/), zaś w R odpowiada za nią funkcja `qnorm()`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# patrząc od lewej\nqnorm(0.9, 100, 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 119.2233\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n# patrząc od prawej\nqnorm(0.1, 100, 15, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 119.2233\n```\n\n\n:::\n:::\n\n\n## Tablice statystyczne\n\nZanim komputery stały się oczywiste dystrybuantę rozkładu normalnego odczytywano z drukowanych tablic. Do dziś można je znaleźć w podręcznikach do statystyki czy tablicach do zadań. Warto umieć je czytać, dlatego omówię je krótko.\n\n### Standaryzacja\n\nKażdy rozkład normalny jest opisywany przez swoją średnią i odchylenie standardowe. Możemy wymyślać dowolne rozkłady normalne manipulując tymi dwiema wartościami. Cały ten wpis posługiwaliśmy się skalą inteligencji, a więc rozkładem normalnym o parametrach $\\mu = 100$ i $\\sigma = 15$. Istnieją jeszcze inne rozkłady stosowane w psychologii, np. steny (m.in. wyniki NEO-PI-R, czyli testu osobowości wg Wielkiej Piątki) z parametrami $\\mu = 5,5$ i $\\sigma = 2$ czy teny (m.in. potężny kliniczny test MMPI) z parametrami $\\mu = 50$ i $\\sigma = 10$. Matką wszystkich rozkładów normalnych jest jednak tzw. **standardowy rozkład normalny**, czyli spreparowany tak, by średnia wynosiła $\\mu = 0$, a odchylenie standardowe $\\sigma = 1$.\n\nWynik z każdego rozkładu normalnego da się przeliczyć na standardowy rozkład normalny, co często się robi. Prawo trzech sigm pokazuje, że człowiek może nauczyć się myśleć w odchyleniach standardowych. Ponieważ standardowy rozkład normalny jest... standardowy, to wszystkie tablice są skalibrowane pod niego. By móc skorzystać ze zwykłych tablic statystycznych, musimy umieć **wystandaryzować** daną wartość, czyli przedstawić ją właśnie w postaci odchyleń standardowych. Istnieją do tego [kalkulatory](https://www.danielsoper.com/statcalc/calculator.aspx?id=22), ale wzór jest tutaj naprawdę prosty. Od wyniku odejmujemy średnią, dzięki czemu będzie on dodatni, jeśli jest wyższy od średniej i ujemny, jeśli jest niższy. Potem dzielimy otrzymaną liczbę przez odchylenie standardowe i już. Tak otrzymaną wartość oznaczamy literą $Z$ (tzw. *Z-score*).\n\n$$\nZ(x) = \\frac{x - \\mu}{\\sigma}\n$$\n\n## Korzystanie\n\n\n::: {#tbl-tablica-rozkladu-normalnego .cell tbl-cap='Przykładowa tablica dystrybuanty rozkładu normalnego z zaznaczonymi wartościami dla *Z* = 1,67 i *Z* = 1,33.'}\n\n```{.r .cell-code}\nnorm_table <- seq(0, 3.09, by = 0.01) %>%\n    pnorm() %>%\n    matrix(\n        ncol = 10,\n        byrow = TRUE,\n        dimnames = list(\n            format(seq(0, 3, 0.1), decimal.mark = \",\"),\n            paste0(\"0,0\", 0:9)\n        )\n    ) %>%\n    round(4) %>%\n    format(decimal.mark = \",\")\n\nnorm_table[\"1,6\", \"0,07\"] <- cell_spec(norm_table[\"1,6\", \"0,07\"], bold = TRUE)\nnorm_table[\"1,3\", \"0,03\"] <- cell_spec(norm_table[\"1,3\", \"0,03\"], bold = TRUE)\n\nkbl(norm_table, escape = FALSE) %>%\n    column_spec(1, bold = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> 0,00 </th>\n   <th style=\"text-align:left;\"> 0,01 </th>\n   <th style=\"text-align:left;\"> 0,02 </th>\n   <th style=\"text-align:left;\"> 0,03 </th>\n   <th style=\"text-align:left;\"> 0,04 </th>\n   <th style=\"text-align:left;\"> 0,05 </th>\n   <th style=\"text-align:left;\"> 0,06 </th>\n   <th style=\"text-align:left;\"> 0,07 </th>\n   <th style=\"text-align:left;\"> 0,08 </th>\n   <th style=\"text-align:left;\"> 0,09 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,0 </td>\n   <td style=\"text-align:left;\"> 0,5000 </td>\n   <td style=\"text-align:left;\"> 0,5040 </td>\n   <td style=\"text-align:left;\"> 0,5080 </td>\n   <td style=\"text-align:left;\"> 0,5120 </td>\n   <td style=\"text-align:left;\"> 0,5160 </td>\n   <td style=\"text-align:left;\"> 0,5199 </td>\n   <td style=\"text-align:left;\"> 0,5239 </td>\n   <td style=\"text-align:left;\"> 0,5279 </td>\n   <td style=\"text-align:left;\"> 0,5319 </td>\n   <td style=\"text-align:left;\"> 0,5359 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,1 </td>\n   <td style=\"text-align:left;\"> 0,5398 </td>\n   <td style=\"text-align:left;\"> 0,5438 </td>\n   <td style=\"text-align:left;\"> 0,5478 </td>\n   <td style=\"text-align:left;\"> 0,5517 </td>\n   <td style=\"text-align:left;\"> 0,5557 </td>\n   <td style=\"text-align:left;\"> 0,5596 </td>\n   <td style=\"text-align:left;\"> 0,5636 </td>\n   <td style=\"text-align:left;\"> 0,5675 </td>\n   <td style=\"text-align:left;\"> 0,5714 </td>\n   <td style=\"text-align:left;\"> 0,5753 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,2 </td>\n   <td style=\"text-align:left;\"> 0,5793 </td>\n   <td style=\"text-align:left;\"> 0,5832 </td>\n   <td style=\"text-align:left;\"> 0,5871 </td>\n   <td style=\"text-align:left;\"> 0,5910 </td>\n   <td style=\"text-align:left;\"> 0,5948 </td>\n   <td style=\"text-align:left;\"> 0,5987 </td>\n   <td style=\"text-align:left;\"> 0,6026 </td>\n   <td style=\"text-align:left;\"> 0,6064 </td>\n   <td style=\"text-align:left;\"> 0,6103 </td>\n   <td style=\"text-align:left;\"> 0,6141 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,3 </td>\n   <td style=\"text-align:left;\"> 0,6179 </td>\n   <td style=\"text-align:left;\"> 0,6217 </td>\n   <td style=\"text-align:left;\"> 0,6255 </td>\n   <td style=\"text-align:left;\"> 0,6293 </td>\n   <td style=\"text-align:left;\"> 0,6331 </td>\n   <td style=\"text-align:left;\"> 0,6368 </td>\n   <td style=\"text-align:left;\"> 0,6406 </td>\n   <td style=\"text-align:left;\"> 0,6443 </td>\n   <td style=\"text-align:left;\"> 0,6480 </td>\n   <td style=\"text-align:left;\"> 0,6517 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,4 </td>\n   <td style=\"text-align:left;\"> 0,6554 </td>\n   <td style=\"text-align:left;\"> 0,6591 </td>\n   <td style=\"text-align:left;\"> 0,6628 </td>\n   <td style=\"text-align:left;\"> 0,6664 </td>\n   <td style=\"text-align:left;\"> 0,6700 </td>\n   <td style=\"text-align:left;\"> 0,6736 </td>\n   <td style=\"text-align:left;\"> 0,6772 </td>\n   <td style=\"text-align:left;\"> 0,6808 </td>\n   <td style=\"text-align:left;\"> 0,6844 </td>\n   <td style=\"text-align:left;\"> 0,6879 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,5 </td>\n   <td style=\"text-align:left;\"> 0,6915 </td>\n   <td style=\"text-align:left;\"> 0,6950 </td>\n   <td style=\"text-align:left;\"> 0,6985 </td>\n   <td style=\"text-align:left;\"> 0,7019 </td>\n   <td style=\"text-align:left;\"> 0,7054 </td>\n   <td style=\"text-align:left;\"> 0,7088 </td>\n   <td style=\"text-align:left;\"> 0,7123 </td>\n   <td style=\"text-align:left;\"> 0,7157 </td>\n   <td style=\"text-align:left;\"> 0,7190 </td>\n   <td style=\"text-align:left;\"> 0,7224 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,6 </td>\n   <td style=\"text-align:left;\"> 0,7257 </td>\n   <td style=\"text-align:left;\"> 0,7291 </td>\n   <td style=\"text-align:left;\"> 0,7324 </td>\n   <td style=\"text-align:left;\"> 0,7357 </td>\n   <td style=\"text-align:left;\"> 0,7389 </td>\n   <td style=\"text-align:left;\"> 0,7422 </td>\n   <td style=\"text-align:left;\"> 0,7454 </td>\n   <td style=\"text-align:left;\"> 0,7486 </td>\n   <td style=\"text-align:left;\"> 0,7517 </td>\n   <td style=\"text-align:left;\"> 0,7549 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,7 </td>\n   <td style=\"text-align:left;\"> 0,7580 </td>\n   <td style=\"text-align:left;\"> 0,7611 </td>\n   <td style=\"text-align:left;\"> 0,7642 </td>\n   <td style=\"text-align:left;\"> 0,7673 </td>\n   <td style=\"text-align:left;\"> 0,7704 </td>\n   <td style=\"text-align:left;\"> 0,7734 </td>\n   <td style=\"text-align:left;\"> 0,7764 </td>\n   <td style=\"text-align:left;\"> 0,7794 </td>\n   <td style=\"text-align:left;\"> 0,7823 </td>\n   <td style=\"text-align:left;\"> 0,7852 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,8 </td>\n   <td style=\"text-align:left;\"> 0,7881 </td>\n   <td style=\"text-align:left;\"> 0,7910 </td>\n   <td style=\"text-align:left;\"> 0,7939 </td>\n   <td style=\"text-align:left;\"> 0,7967 </td>\n   <td style=\"text-align:left;\"> 0,7995 </td>\n   <td style=\"text-align:left;\"> 0,8023 </td>\n   <td style=\"text-align:left;\"> 0,8051 </td>\n   <td style=\"text-align:left;\"> 0,8078 </td>\n   <td style=\"text-align:left;\"> 0,8106 </td>\n   <td style=\"text-align:left;\"> 0,8133 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 0,9 </td>\n   <td style=\"text-align:left;\"> 0,8159 </td>\n   <td style=\"text-align:left;\"> 0,8186 </td>\n   <td style=\"text-align:left;\"> 0,8212 </td>\n   <td style=\"text-align:left;\"> 0,8238 </td>\n   <td style=\"text-align:left;\"> 0,8264 </td>\n   <td style=\"text-align:left;\"> 0,8289 </td>\n   <td style=\"text-align:left;\"> 0,8315 </td>\n   <td style=\"text-align:left;\"> 0,8340 </td>\n   <td style=\"text-align:left;\"> 0,8365 </td>\n   <td style=\"text-align:left;\"> 0,8389 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,0 </td>\n   <td style=\"text-align:left;\"> 0,8413 </td>\n   <td style=\"text-align:left;\"> 0,8438 </td>\n   <td style=\"text-align:left;\"> 0,8461 </td>\n   <td style=\"text-align:left;\"> 0,8485 </td>\n   <td style=\"text-align:left;\"> 0,8508 </td>\n   <td style=\"text-align:left;\"> 0,8531 </td>\n   <td style=\"text-align:left;\"> 0,8554 </td>\n   <td style=\"text-align:left;\"> 0,8577 </td>\n   <td style=\"text-align:left;\"> 0,8599 </td>\n   <td style=\"text-align:left;\"> 0,8621 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,1 </td>\n   <td style=\"text-align:left;\"> 0,8643 </td>\n   <td style=\"text-align:left;\"> 0,8665 </td>\n   <td style=\"text-align:left;\"> 0,8686 </td>\n   <td style=\"text-align:left;\"> 0,8708 </td>\n   <td style=\"text-align:left;\"> 0,8729 </td>\n   <td style=\"text-align:left;\"> 0,8749 </td>\n   <td style=\"text-align:left;\"> 0,8770 </td>\n   <td style=\"text-align:left;\"> 0,8790 </td>\n   <td style=\"text-align:left;\"> 0,8810 </td>\n   <td style=\"text-align:left;\"> 0,8830 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,2 </td>\n   <td style=\"text-align:left;\"> 0,8849 </td>\n   <td style=\"text-align:left;\"> 0,8869 </td>\n   <td style=\"text-align:left;\"> 0,8888 </td>\n   <td style=\"text-align:left;\"> 0,8907 </td>\n   <td style=\"text-align:left;\"> 0,8925 </td>\n   <td style=\"text-align:left;\"> 0,8944 </td>\n   <td style=\"text-align:left;\"> 0,8962 </td>\n   <td style=\"text-align:left;\"> 0,8980 </td>\n   <td style=\"text-align:left;\"> 0,8997 </td>\n   <td style=\"text-align:left;\"> 0,9015 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,3 </td>\n   <td style=\"text-align:left;\"> 0,9032 </td>\n   <td style=\"text-align:left;\"> 0,9049 </td>\n   <td style=\"text-align:left;\"> 0,9066 </td>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">0,9082</span> </td>\n   <td style=\"text-align:left;\"> 0,9099 </td>\n   <td style=\"text-align:left;\"> 0,9115 </td>\n   <td style=\"text-align:left;\"> 0,9131 </td>\n   <td style=\"text-align:left;\"> 0,9147 </td>\n   <td style=\"text-align:left;\"> 0,9162 </td>\n   <td style=\"text-align:left;\"> 0,9177 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,4 </td>\n   <td style=\"text-align:left;\"> 0,9192 </td>\n   <td style=\"text-align:left;\"> 0,9207 </td>\n   <td style=\"text-align:left;\"> 0,9222 </td>\n   <td style=\"text-align:left;\"> 0,9236 </td>\n   <td style=\"text-align:left;\"> 0,9251 </td>\n   <td style=\"text-align:left;\"> 0,9265 </td>\n   <td style=\"text-align:left;\"> 0,9279 </td>\n   <td style=\"text-align:left;\"> 0,9292 </td>\n   <td style=\"text-align:left;\"> 0,9306 </td>\n   <td style=\"text-align:left;\"> 0,9319 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,5 </td>\n   <td style=\"text-align:left;\"> 0,9332 </td>\n   <td style=\"text-align:left;\"> 0,9345 </td>\n   <td style=\"text-align:left;\"> 0,9357 </td>\n   <td style=\"text-align:left;\"> 0,9370 </td>\n   <td style=\"text-align:left;\"> 0,9382 </td>\n   <td style=\"text-align:left;\"> 0,9394 </td>\n   <td style=\"text-align:left;\"> 0,9406 </td>\n   <td style=\"text-align:left;\"> 0,9418 </td>\n   <td style=\"text-align:left;\"> 0,9429 </td>\n   <td style=\"text-align:left;\"> 0,9441 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,6 </td>\n   <td style=\"text-align:left;\"> 0,9452 </td>\n   <td style=\"text-align:left;\"> 0,9463 </td>\n   <td style=\"text-align:left;\"> 0,9474 </td>\n   <td style=\"text-align:left;\"> 0,9484 </td>\n   <td style=\"text-align:left;\"> 0,9495 </td>\n   <td style=\"text-align:left;\"> 0,9505 </td>\n   <td style=\"text-align:left;\"> 0,9515 </td>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">0,9525</span> </td>\n   <td style=\"text-align:left;\"> 0,9535 </td>\n   <td style=\"text-align:left;\"> 0,9545 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,7 </td>\n   <td style=\"text-align:left;\"> 0,9554 </td>\n   <td style=\"text-align:left;\"> 0,9564 </td>\n   <td style=\"text-align:left;\"> 0,9573 </td>\n   <td style=\"text-align:left;\"> 0,9582 </td>\n   <td style=\"text-align:left;\"> 0,9591 </td>\n   <td style=\"text-align:left;\"> 0,9599 </td>\n   <td style=\"text-align:left;\"> 0,9608 </td>\n   <td style=\"text-align:left;\"> 0,9616 </td>\n   <td style=\"text-align:left;\"> 0,9625 </td>\n   <td style=\"text-align:left;\"> 0,9633 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,8 </td>\n   <td style=\"text-align:left;\"> 0,9641 </td>\n   <td style=\"text-align:left;\"> 0,9649 </td>\n   <td style=\"text-align:left;\"> 0,9656 </td>\n   <td style=\"text-align:left;\"> 0,9664 </td>\n   <td style=\"text-align:left;\"> 0,9671 </td>\n   <td style=\"text-align:left;\"> 0,9678 </td>\n   <td style=\"text-align:left;\"> 0,9686 </td>\n   <td style=\"text-align:left;\"> 0,9693 </td>\n   <td style=\"text-align:left;\"> 0,9699 </td>\n   <td style=\"text-align:left;\"> 0,9706 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 1,9 </td>\n   <td style=\"text-align:left;\"> 0,9713 </td>\n   <td style=\"text-align:left;\"> 0,9719 </td>\n   <td style=\"text-align:left;\"> 0,9726 </td>\n   <td style=\"text-align:left;\"> 0,9732 </td>\n   <td style=\"text-align:left;\"> 0,9738 </td>\n   <td style=\"text-align:left;\"> 0,9744 </td>\n   <td style=\"text-align:left;\"> 0,9750 </td>\n   <td style=\"text-align:left;\"> 0,9756 </td>\n   <td style=\"text-align:left;\"> 0,9761 </td>\n   <td style=\"text-align:left;\"> 0,9767 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,0 </td>\n   <td style=\"text-align:left;\"> 0,9772 </td>\n   <td style=\"text-align:left;\"> 0,9778 </td>\n   <td style=\"text-align:left;\"> 0,9783 </td>\n   <td style=\"text-align:left;\"> 0,9788 </td>\n   <td style=\"text-align:left;\"> 0,9793 </td>\n   <td style=\"text-align:left;\"> 0,9798 </td>\n   <td style=\"text-align:left;\"> 0,9803 </td>\n   <td style=\"text-align:left;\"> 0,9808 </td>\n   <td style=\"text-align:left;\"> 0,9812 </td>\n   <td style=\"text-align:left;\"> 0,9817 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,1 </td>\n   <td style=\"text-align:left;\"> 0,9821 </td>\n   <td style=\"text-align:left;\"> 0,9826 </td>\n   <td style=\"text-align:left;\"> 0,9830 </td>\n   <td style=\"text-align:left;\"> 0,9834 </td>\n   <td style=\"text-align:left;\"> 0,9838 </td>\n   <td style=\"text-align:left;\"> 0,9842 </td>\n   <td style=\"text-align:left;\"> 0,9846 </td>\n   <td style=\"text-align:left;\"> 0,9850 </td>\n   <td style=\"text-align:left;\"> 0,9854 </td>\n   <td style=\"text-align:left;\"> 0,9857 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,2 </td>\n   <td style=\"text-align:left;\"> 0,9861 </td>\n   <td style=\"text-align:left;\"> 0,9864 </td>\n   <td style=\"text-align:left;\"> 0,9868 </td>\n   <td style=\"text-align:left;\"> 0,9871 </td>\n   <td style=\"text-align:left;\"> 0,9875 </td>\n   <td style=\"text-align:left;\"> 0,9878 </td>\n   <td style=\"text-align:left;\"> 0,9881 </td>\n   <td style=\"text-align:left;\"> 0,9884 </td>\n   <td style=\"text-align:left;\"> 0,9887 </td>\n   <td style=\"text-align:left;\"> 0,9890 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,3 </td>\n   <td style=\"text-align:left;\"> 0,9893 </td>\n   <td style=\"text-align:left;\"> 0,9896 </td>\n   <td style=\"text-align:left;\"> 0,9898 </td>\n   <td style=\"text-align:left;\"> 0,9901 </td>\n   <td style=\"text-align:left;\"> 0,9904 </td>\n   <td style=\"text-align:left;\"> 0,9906 </td>\n   <td style=\"text-align:left;\"> 0,9909 </td>\n   <td style=\"text-align:left;\"> 0,9911 </td>\n   <td style=\"text-align:left;\"> 0,9913 </td>\n   <td style=\"text-align:left;\"> 0,9916 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,4 </td>\n   <td style=\"text-align:left;\"> 0,9918 </td>\n   <td style=\"text-align:left;\"> 0,9920 </td>\n   <td style=\"text-align:left;\"> 0,9922 </td>\n   <td style=\"text-align:left;\"> 0,9925 </td>\n   <td style=\"text-align:left;\"> 0,9927 </td>\n   <td style=\"text-align:left;\"> 0,9929 </td>\n   <td style=\"text-align:left;\"> 0,9931 </td>\n   <td style=\"text-align:left;\"> 0,9932 </td>\n   <td style=\"text-align:left;\"> 0,9934 </td>\n   <td style=\"text-align:left;\"> 0,9936 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,5 </td>\n   <td style=\"text-align:left;\"> 0,9938 </td>\n   <td style=\"text-align:left;\"> 0,9940 </td>\n   <td style=\"text-align:left;\"> 0,9941 </td>\n   <td style=\"text-align:left;\"> 0,9943 </td>\n   <td style=\"text-align:left;\"> 0,9945 </td>\n   <td style=\"text-align:left;\"> 0,9946 </td>\n   <td style=\"text-align:left;\"> 0,9948 </td>\n   <td style=\"text-align:left;\"> 0,9949 </td>\n   <td style=\"text-align:left;\"> 0,9951 </td>\n   <td style=\"text-align:left;\"> 0,9952 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,6 </td>\n   <td style=\"text-align:left;\"> 0,9953 </td>\n   <td style=\"text-align:left;\"> 0,9955 </td>\n   <td style=\"text-align:left;\"> 0,9956 </td>\n   <td style=\"text-align:left;\"> 0,9957 </td>\n   <td style=\"text-align:left;\"> 0,9959 </td>\n   <td style=\"text-align:left;\"> 0,9960 </td>\n   <td style=\"text-align:left;\"> 0,9961 </td>\n   <td style=\"text-align:left;\"> 0,9962 </td>\n   <td style=\"text-align:left;\"> 0,9963 </td>\n   <td style=\"text-align:left;\"> 0,9964 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,7 </td>\n   <td style=\"text-align:left;\"> 0,9965 </td>\n   <td style=\"text-align:left;\"> 0,9966 </td>\n   <td style=\"text-align:left;\"> 0,9967 </td>\n   <td style=\"text-align:left;\"> 0,9968 </td>\n   <td style=\"text-align:left;\"> 0,9969 </td>\n   <td style=\"text-align:left;\"> 0,9970 </td>\n   <td style=\"text-align:left;\"> 0,9971 </td>\n   <td style=\"text-align:left;\"> 0,9972 </td>\n   <td style=\"text-align:left;\"> 0,9973 </td>\n   <td style=\"text-align:left;\"> 0,9974 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,8 </td>\n   <td style=\"text-align:left;\"> 0,9974 </td>\n   <td style=\"text-align:left;\"> 0,9975 </td>\n   <td style=\"text-align:left;\"> 0,9976 </td>\n   <td style=\"text-align:left;\"> 0,9977 </td>\n   <td style=\"text-align:left;\"> 0,9977 </td>\n   <td style=\"text-align:left;\"> 0,9978 </td>\n   <td style=\"text-align:left;\"> 0,9979 </td>\n   <td style=\"text-align:left;\"> 0,9979 </td>\n   <td style=\"text-align:left;\"> 0,9980 </td>\n   <td style=\"text-align:left;\"> 0,9981 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 2,9 </td>\n   <td style=\"text-align:left;\"> 0,9981 </td>\n   <td style=\"text-align:left;\"> 0,9982 </td>\n   <td style=\"text-align:left;\"> 0,9982 </td>\n   <td style=\"text-align:left;\"> 0,9983 </td>\n   <td style=\"text-align:left;\"> 0,9984 </td>\n   <td style=\"text-align:left;\"> 0,9984 </td>\n   <td style=\"text-align:left;\"> 0,9985 </td>\n   <td style=\"text-align:left;\"> 0,9985 </td>\n   <td style=\"text-align:left;\"> 0,9986 </td>\n   <td style=\"text-align:left;\"> 0,9986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> 3,0 </td>\n   <td style=\"text-align:left;\"> 0,9987 </td>\n   <td style=\"text-align:left;\"> 0,9987 </td>\n   <td style=\"text-align:left;\"> 0,9987 </td>\n   <td style=\"text-align:left;\"> 0,9988 </td>\n   <td style=\"text-align:left;\"> 0,9988 </td>\n   <td style=\"text-align:left;\"> 0,9989 </td>\n   <td style=\"text-align:left;\"> 0,9989 </td>\n   <td style=\"text-align:left;\"> 0,9989 </td>\n   <td style=\"text-align:left;\"> 0,9990 </td>\n   <td style=\"text-align:left;\"> 0,9990 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nSpróbujmy wykorzystać tablicę [-@tbl-tablica-rozkladu-normalnego], żeby rozwiązać problem z prawdopodobieństwem wylosowania osoby z IQ między 80 a 125. Najpierw musimy przeliczyć nasze wartości ze skali IQ na skalę standardową.\n\n$$\n\\begin{align*}\nZ(125) & = \\frac{125 - 100}{15} = \\frac{25}{15} \\approx 1,67 \\\\\nZ(80) & = \\frac{80 - 100}{15} = \\frac{-20}{15} \\approx -1,33\n\\end{align*}\n$$\n\nTeraz możemy odczytać stosowne wartości dystrybuanty z tabeli. Zacznijmy od górnych widełek. Z lewej strony szukam wartości 1,6 i patrzę w kolumnę oznaczoną 0,07, bo razem daje to 1,67. Więcej problemu sprawi wartość -1,33, bo jest ujemna, zaś tabela składa się z wartości dodatnich. Jednak wiemy, że rozkład normalny jest symetryczny, czyli wartość przy $Z = -1,33$ będzie taka sama, jak odwrotność wartości dla $Z = 1,33$. Słowny opis jest mało zrozumiały, więc posłużmy się wykresem.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tibble(X = seq(-3.2, 3.2, 0.01)), aes(X)) +\n    geom_area(stat = \"function\", fun = dnorm, fill = \"gray95\") +\n    geom_area(stat = \"function\", fun = dnorm, fill = \"#DB3D3D\", xlim = c(-3.2, -1.33)) +\n    geom_area(stat = \"function\", fun = dnorm, fill = \"#DB3D3D\", xlim = c(1.33, 3.2)) +\n    stat_function(fun = dnorm) +\n    labs(x = \"Z\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent) +\n    scale_x_continuous(breaks = c(-3, -2, -1.33, 0, 1.33, 2, 3)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nObszary zaznaczone na czerwono są identyczne. Możemy więc policzyć wartość dla -1,33 stosując sztuczkę z podrozdziału [-@sec-pomiedzy]. -- wziąć wartość dla 1,33 i odjąć ją od 1. Otrzymamy w ten sposób powierzchnię z prawej, która jest taka sama, jak powierzchnia z lewej.\n\nW ten sposób możemy odczytać, że górne widełki mają wartość dystrybuanty $P(x < 1,67) = 0,9525$, zaś dolne $P(x < -1,33) = 1 - 0,9082 = 0,0918$. Teraz możemy odjąć jedno od drugiego, żeby otrzymać prawdopodobieństwo, że wylosowane IQ będzie między 80 a 125.\n\n$$\n\\begin{align*}\nP(80 < IQ < 125) & = \\\\\n= P(-1,33 < Z(IQ) < 1,67) & = \\\\\n& = 0,9525 - 0,0918 = \\\\\n& = 0,8607\n\\end{align*}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tibble(X = seq(-3.2, 3.2, 0.01)), aes(X)) +\n    geom_area(stat = \"function\", fun = dnorm, fill = \"gray95\") +\n    geom_area(stat = \"function\", fun = dnorm, fill = \"#DB3D3D\", xlim = c(-1.33, 1.67)) +\n    stat_function(fun = dnorm) +\n    labs(x = \"Z\", y = \"gęstość prawdopodobieństwa\") +\n    scale_y_continuous(labels = scales::percent) +\n    scale_x_continuous(breaks = seq(-3, 3)) +\n    theme_Publication()\n```\n\n::: {.cell-output-display}\n![](gestosc-prawdopodobienstwa_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nJak wygląda dokładność tego wyniku w porównaniu do tego wyrzucanego przez R? Całkiem nieźle. Rozbieżności pojawiają się dopiero na czwartym miejscu po przecinku.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# ze standardowego rozkładu normalnego\npnorm(1.67) - pnorm(-1.33)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8607812\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n# z rozkładu inteligencji\npnorm(125, 100, 15) - pnorm(80, 100, 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8609984\n```\n\n\n:::\n:::\n\n\n::: callout-tip\n## Zadanie\nKorzystając z tablic rozkładu normalnego oblicz, jakie jest prawdopodobieństwo, że losowo wybrana osoba będzie miała IQ typu „tak blisko!”, czyli między 125 a 129. Zanim sprawdzisz odpowiedź niżej, spróbuj sprawdzić ją na kalkulatorze lub w R.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Odpowiedź\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\npnorm(129, 100, 15) - pnorm(125, 100, 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02119278\n```\n\n\n:::\n:::\n\n:::\n\n# Podsumowanie\n\n1.  Słupki histogramu funkcjonują jak widełki -- pokazują jaka część próbki (lub populacji) ma daną nasilenie danej cechy między wartością $a$, a wartością $b$. Im słupki węższe, tym dokładniejszy histogram, ale same słupki niższe.\n\n2.  Jeśli oś Y histogramu przedstawimy w postaci procentów, możemy rozumieć go jako wykres prawdopodobieństwa wylosowania osób o danym nasileniu danej cechy albo jako wykres odsetka populacji o danym nasileniu danej cechy. To to samo.\n\n2.  Wykres gęstości można rozumieć jako histogram z nieskończenie cienkimi słupkami. Nie są one przy okazji nieskończenie niskie przez techniki matematyczne używane do ich tworzenia.\n\n3.  Dla inteligencji (i wielu innych cech) wykres gęstości z bardzo dużej próbki ma kształt krzywej dzwonowej. Innymi słowy rozkład inteligencji jest normalny. Inteligencję zwyczajowo przedstawia się na skali normalnej ze średnią $\\mu = 100$ i odchyleniem standardowym $\\sigma = 15$.\n\n4.  Z osi Y wykresu gęstości prawdopodobieństwa możemy odczytać *gęstość prawdopodobieństwa* (*likelihood*), ale nie prawdopodobieństwo (*probability*). **Gęstość prawdopodobieństwa i prawdopodobieństwo to dwie różne rzeczy!**\n\n5.  Prawdopodobieństwo na wykresach gęstości to **pole pod krzywą gęstości**, czyli suma pól nieskończenie cienkich prostokątów, z których jest ono zbudowane. Zapisać to możemy jako $\\int_a^b \\mathcal{N}(x;\\ \\mu,\\ \\sigma^2)dx$. Zawsze jednak potrzebujemy jakichś widełek, choćby bardzo wąskich; nie możemy policzyć pola pod punktem.\n\n6.  Możemy oszacować pole pod krzywą dzwonową (czyli prawdopodobieństwo) dzieląc je na mniejsze prostokąty. Szerokość takiego prostokąta ustalamy sami, zaś wysokość to gęstość prawdopodobieństwa w danym punkcie. Pola takich prostokątów możemy policzyć i dodać. Im prostokąty cieńsze, tym dokładniejsze oszacowanie.\n\n8.  Zazwyczaj do określania prawdopodobieństwa z rozkładu służy funkcja zwana dystrybuantą. Wrzuca się do niej wartość (np. IQ lub Z), a ona zwraca prawdopodobieństwo wylosowania wartości takiej **lub niższej**. W R dystrybuanta rozkładu normalnego ma postać `pnorm(x, mean = 0, sd = 1)`.\n\n9.  Za pomocą dystrybuanty możemy też policzyć prawdopodobieństwo, że wartość jest *wyższa* od zadanej odejmując wartość dystrybuanty w punkcie od 1. Możemy też policzyć prawdopodobieństwo wylosowania wartości z określonych widełek najpierw licząc widełki górne, a potem widełki dolne.\n\n10. Standardowy rozkład normalny ma średnią $\\mu = 0$ i odchylenie standardowe $\\sigma = 1$. Wartość wyrażona na tej skali oznaczana jest jako $Z$. Każdą skalę możemy przeliczyć na skalę standardową od wartości odejmując średnią i dzieląc wynik przez odchylenie standardowe. $$Z(x) = \\frac{x - \\mu}{\\sigma}$$",
    "supporting": [
      "gestosc-prawdopodobienstwa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}